import{e as x,aB as N,aC as P,p as S,a as V,A as G,m as d,Y as w,h as b,o as m,l as i,s as a,O as c,Z as y,k as n,U as u,N as B,V as f,a6 as q}from"./vue-DTj65VEW.js";import{x as E,u as K,y as T,_ as j}from"./index-D_nuE6M8.js";import{u as O,b as Y,c as Z}from"./index-BwvoFoZH.js";import{c as H}from"./index-CBEmek3y.js";import{F as A}from"./index-Cxc02btj.js";import{b as v}from"./validate-CF98adGt.js";const J={key:0,class:"userinfo"},Q={class:"user-avatar-box"},W=["src"],X={class:"username"},ee={class:"user-info"},ae={class:"userinfo-buttons"},oe={href:"https://uni.buildadmin.com/user",target:"_blank",rel:"noopener noreferrer"},te={key:1,class:"ba-login"},se={class:"ba-title"},ne={target:"_blank",class:"ba-account-register",href:"https://uni.buildadmin.com/user/login?type=register",rel:"noopener noreferrer"},le=x({__name:"baAccount",props:N({loginCallback:{type:Function,default:()=>{}}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:["update:modelValue"],setup(h){const{t:l}=E.useI18n(),t=O(),C=K(),g=P(h,"modelValue"),_=S(),F=h,o=V({loading:!0,submitLoading:!1,user:{tab:"login",username:"",password:"",captchaId:T(),captchaInfo:"",keep:!1}}),k=()=>{_.value&&_.value.validate(s=>{s&&H(o.user.captchaId,e=>L(e),{apiBaseURL:C.apiUrl})})},L=(s="")=>{o.submitLoading=!0,o.user.captchaInfo=s,Y(o.user).then(e=>{t.dataFill(e.data.userInfo,!1),F.loginCallback(e)}).finally(()=>{o.submitLoading=!1})},U=V({username:[v({name:"required",title:l("layouts.Username")})],password:[v({name:"required",title:l("layouts.Password")}),v({name:"password"})]});return G(()=>g.value,s=>{s&&t.token&&Z().then(e=>{t.dataFill(e.data.userInfo)}).catch(()=>{t.removeToken()}).finally(()=>{o.loading=!1})}),(s,e)=>{const z=d("Icon"),p=d("el-button"),$=d("el-form-item"),D=d("el-form"),M=d("el-dialog"),I=w("blur"),R=w("loading");return m(),b("div",null,[i(M,{modelValue:g.value,"onUpdate:modelValue":e[5]||(e[5]=r=>g.value=r),class:"ba-account-dialog",width:"25%",title:a(l)("layouts.Member information")},{default:c(()=>[a(t).token?y((m(),b("div",J,[n("div",Q,[n("img",{class:"user-avatar",src:a(t).avatar,alt:""},null,8,W),i(z,{class:"user-avatar-gender",name:a(t).getGenderIcon().name,size:"14",color:a(t).getGenderIcon().color},null,8,["name","color"])]),n("p",X,u(a(t).nickname),1),n("p",ee,[n("span",null,u(s.$t("Integral")+" "+a(t).score),1),n("span",null,u(s.$t("Balance")+" "+a(t).money),1)]),n("div",ae,[n("a",oe,[y((m(),B(p,{size:"default",type:"primary"},{default:c(()=>[f(u(s.$t("layouts.Member center")),1)]),_:1})),[[I]])]),y((m(),B(p,{onClick:e[0]||(e[0]=r=>a(t).logout()),size:"default",type:"warning"},{default:c(()=>[f(u(s.$t("layouts.Logout")),1)]),_:1})),[[I]])])])),[[R,o.loading]]):(m(),b("div",te,[n("h3",se,u(a(l)("layouts.Login to the buildadmin")),1),i(D,{onKeyup:e[4]||(e[4]=q(r=>k(),["enter"])),ref_key:"baAccountFormRef",ref:_,rules:U,class:"ba-account-login-form",model:o.user},{default:c(()=>[i(A,{modelValue:o.user.username,"onUpdate:modelValue":e[1]||(e[1]=r=>o.user.username=r),type:"string",prop:"username",placeholder:a(l)("layouts.Please enter buildadmin account name or email"),"input-attr":{size:"large"}},null,8,["modelValue","placeholder"]),i(A,{modelValue:o.user.password,"onUpdate:modelValue":e[2]||(e[2]=r=>o.user.password=r),type:"password",prop:"password",placeholder:a(l)("layouts.Please enter the buildadmin account password"),"input-attr":{size:"large"}},null,8,["modelValue","placeholder"]),i($,{class:"form-buttons"},{default:c(()=>[i(p,{onClick:e[3]||(e[3]=r=>k()),loading:o.submitLoading,round:"",type:"primary",size:"large"},{default:c(()=>[f(u(a(l)("layouts.Login")),1)]),_:1},8,["loading"]),n("a",ne,[i(p,{round:"",plain:"",type:"info",size:"large"},{default:c(()=>[f(u(a(l)("layouts.Register")),1)]),_:1})])]),_:1})]),_:1},8,["rules","model"])]))]),_:1},8,["modelValue","title"])])}}}),pe=j(le,[["__scopeId","data-v-2eb233fa"]]);export{pe as B};
